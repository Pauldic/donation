{% load i18n static notifications_tags %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="fb:app_id" content="{{ fbid }}" />
    <meta property="og:url" content="http://www.gmbenefit.org" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="GMB Community" />
    <meta property="og:site_name" content="Genuine Mutural Benefit" />
    <meta property="og:description" content="Just the best Community" />
    <meta property="og:image" content="https://www.gmbenefit.org/static/front/images/bg.jpg" />

    <title>GMB</title>
    <!-- PACE-->
    <link rel="stylesheet" type="text/css" href="{% static 'pace/themes/blue/pace-theme-flash.css' %}">
    <script type="text/javascript" src="{% static 'pace/pace.min.js' %}"></script>
    <!-- Bootstrap CSS-->
    <link rel="stylesheet" type="text/css" href="{% static 'bootstrap/css/bootstrap.min.css' %}">
    <!-- Fonts-->
    <link rel="stylesheet" type="text/css" href="{% static 'fonts/themify-icons/themify-icons.css' %}">
    <!-- Malihu Scrollbar-->
    <link rel="stylesheet" type="text/css" href="{% static 'malihu-custom-scrollbar-plugin/jquery.mCustomScrollbar.min.css' %}">
    <!-- Animo.js-->
    <link rel="stylesheet" type="text/css" href="{% static 'animo.js/animate-animo.min.css' %}">
    <!-- Bootstrap Progressbar-->
    <link rel="stylesheet" type="text/css" href="{% static 'bootstrap-progressbar/css/bootstrap-progressbar-3.3.4.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'toastr/toastr.min.css' %}">

    <!-- Primary Style-->
    <link rel="stylesheet" type="text/css" href="{% static 'back/css/second-layout.css' %}">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries-->
    <!-- WARNING: Respond.js doesn't work if you view the page via file://-->
    <!--[if lt IE 9]>
    <script type="text/javascript" src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script type="text/javascript" src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- jQuery-->
    <script type="text/javascript" src="{% static 'jQuery/jquery-2.2.3.min.js' %}"></script>

    <style>
        .notification-bar .dropdown-menu > ul li > a {
            padding: 12px 10px
        }

        .search-bar {
            overflow: visible;
        }
        .x12{font-size: 1.2em}
        .x14{font-size: 1.4em}
        .x16{font-size: 1.6em}
        .x18{font-size: 1.8em}
        .x2{font-size: 2.0em}
        .x22{font-size: 2.2em}
        .x24{font-size: 2.4em}
        .x26{font-size: 2.6em}
        .x28{font-size: 2.8em}
        .x3{font-size: 3.0em}
        .x32{font-size: 3.2em}
        .x34{font-size: 3.4em}
        .x36{font-size: 3.6em}
        .x38{font-size: 3.8em}
        .x4{font-size: 4.0em}
    </style>
</head>
<body data-sidebar-color="sidebar-light" class="sidebar-light">
<div id="fb-root"></div>
{#<script>#}
{#  window.fbAsyncInit = function() {#}
{#      FB.init({#}
{#          appId: '{{ fbid }}',#}
{#          cookie: true,#}
{#          xfbml: true,    // Initialize any social plugins#}
{#          status: true,   // Check Login State Useful for FB Login#}
{#          version: 'v2.10'#}
{#      });#}
{#      FB.AppEvents.logPageView();#}
{##}
{#  }#}
{#    FB.ui({#}
{#      method: 'share',#}
{#      href: 'https://www.gmbenefit.org/'#}
{#    }, function(response){});#}
{##}
{#    FB.ui({#}
{#        method: 'share_open_graph',#}
{#        action_type: 'og.likes',#}
{#        action_properties: JSON.stringify({#}
{#            object:'https://www.gmbenefit.org/',#}
{#        })#}
{#    }, function(response){#}
{#        // Debug response (optional)#}
{#        console.log(response);#}
{#    });#}
{#  };#}
{##}
{#      (function (d, s, id) {#}
{#          var js, fjs = d.getElementsByTagName(s)[0];#}
{#          if (d.getElementById(id)) {#}
{#              return;#}
{#          }#}
{#          js = d.createElement(s);#}
{#          js.id = id;#}
{#          js.src = "//connect.facebook.net/en_US/sdk.js";#}
{#          //js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.10&appId=127527781236975";#}
{#          fjs.parentNode.insertBefore(js, fjs);#}
{#      }(document, 'script', 'facebook-jssdk'));#}
{#</script>#}
<script>
    window.fbAsyncInit = function () {
        FB.init({
            appId: '{{ fbid }}',
            cookie: true,
            xfbml: true,    // Initialize any social plugins
            status: true,   // Check Login State Useful for FB Login
            version: 'v2.10'
        });
        FB.AppEvents.logPageView();
    };

    (function (d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) {return;}
        js = d.createElement(s);
        js.id = id;
        js.src = "//connect.facebook.net/en_US/sdk.js";
        //js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.10&appId=127527781236975";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
</script>
{% notifications_unread as unread_count %}
<!-- Header start-->
<header>
    <div class="search-bar closed">
        <form>
            <div class="btn-group">
                <button type="button" class="btn btn-default btn-outline"><img src="{% static 'back/images/flags/us.jpg' %}" alt="" class="flag-icon">English</button>
                <button type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="btn btn-default btn-outline dropdown-toggle"><span class="caret"></span><span
                        class="sr-only">Toggle Dropdown</span></button>
                <ul class="dropdown-menu dropdown-menu-right animated fadeInDown">
                    <li><a href="#"><img src="{% static 'back/images/flags/de.jpg' %}" alt="" class="flag-icon">German</a></li>
                    <li><a href="#"><img src="{% static 'back/images/flags/fr.jpg' %}" alt="" class="flag-icon">French</a></li>
                    <li><a href="#"><img src="{% static 'back/images/flags/es.jpg' %}" alt="" class="flag-icon">Spanish</a></li>
                    <li><a href="#"><img src="{% static 'back/images/flags/it.jpg' %}" alt="" class="flag-icon">Italian</a></li>
                    <li><a href="#"><img src="{% static 'back/images/flags/jp.jpg' %}" alt="" class="flag-icon">Japanese</a></li>
                </ul>
                <button type="button" class="btn btn-default search-bar-toggle"><i class="ti-close"></i></button>
            </div>
            {#            <div class="input-group input-group-lg">#}
            {#                <input type="text" placeholder="Search for...1" class="form-control"><span class="input-group-btn">#}
            {#              <button type="button" class="btn btn-default search-bar-toggle"><i class="ti-close"></i></button></span>#}
            {#            </div>#}
        </form>
    </div>
    <a href="{% url 'core:index' %}" class="brand pull-left">
        <h2>GMB</h2></a><a href="javascript:;" role="button" class="hamburger-menu pull-left visible-xs"><span></span></a>
    {#    <form class="search-form pull-left hidden-xs">#}
    {#        <div class="form-group has-feedback mb-0">#}
    {#            <input type="text" aria-describedby="inputSearchFor" placeholder="Search for...2" style="width: 200px" class="form-control rounded"><span aria-hidden="true"#}
    {#                                                                                                                                                     class="ti-search form-control-feedback"></span><span#}
    {#                id="inputSearchFor" class="sr-only">(default)</span>#}
    {#        </div>#}
    {#    </form>#}

    <div class="search-form pull-left hidden-xs">
        <div class="btn-group">
            <button type="button" class="btn btn-default btn-outline text-white"><img src="{% static 'back/images/flags/us.jpg' %}" alt="" class="flag-icon">English</button>
            <button type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="btn btn-default btn-outline dropdown-toggle"><span class="caret"></span><span
                    class="sr-only">Toggle Dropdown</span></button>
            <ul class="dropdown-menu dropdown-menu-right animated fadeInDown">
                <li><a href="#"><img src="{% static 'back/images/flags/de.jpg' %}" alt="" class="flag-icon">German</a></li>
                <li><a href="#"><img src="{% static 'back/images/flags/fr.jpg' %}" alt="" class="flag-icon">French</a></li>
                <li><a href="#"><img src="{% static 'back/images/flags/es.jpg' %}" alt="" class="flag-icon">Spanish</a></li>
                <li><a href="#"><img src="{% static 'back/images/flags/it.jpg' %}" alt="" class="flag-icon">Italian</a></li>
                <li><a href="#"><img src="{% static 'back/images/flags/jp.jpg' %}" alt="" class="flag-icon">Japanese</a></li>
            </ul>
        </div>
    </div>

    <ul class="notification-bar list-inline pull-right">
        <li class="visible-xs"><a href="javascript:;" role="button" class="header-icon search-bar-toggle"><img src="{% static 'back/images/flags/us.jpg' %}" alt="" class="flag-icon"></a></li>
        <li class="visible-lg"><a href="javascript:;" role="button" class="header-icon fullscreen-toggle"><i class="ti-fullscreen"></i></a></li>
{#        <li><a href="javascript:;" ><i class="emoji" data-value="{{ request.user.member.country.code }}"></i></a></li>#}
        <li class="dropdown">
            <a id="dropdownMenu1" href="#" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle bubble header-icon">
                <i class="ti-world"></i>{% live_notify_badge classes="badge bg-danger" %}</a>

            <div aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right dm-medium fs-12 animated fadeInDown">
                <h5 class="dropdown-header">You have {{ unread_count }} notifications</h5>
                <ul id="custom_live_notify_list" data-mcs-theme="minimal-dark" class="media-list mCustomScrollbar">
                    {#                    <li class="media">#}
                    {#                        <a href="javascript:;">#}
                    {#                            <div class="media-left avatar"><img src="{% static 'back/images/users/17.jpg' %}" alt="" class="media-object img-circle"><span class="status bg-warning"></span></div>#}
                    {#                            <div class="media-body">#}
                    {#                                <h6 class="media-heading">William Carlson</h6>#}
                    {#                                <p class="text-muted mb-0"> Commented on your post Commented on your post Commented on your post</p>#}
                    {#                            </div>#}
                    {#                            <div class="media-right text-nowrap">#}
                    {#                                <time datetime="2015-12-10T20:27:48+07:00" class="fs-11">5 mins</time>#}
                    {#                            </div>#}
                    {#                        </a>#}
                    {#                    </li>#}
                    {% live_notify_list classes="dropdown-menu" %}
                </ul>
                <div class="dropdown-footer text-center p-10"><a href="javascript:;" class="fw-500 text-muted">See all notifications</a></div>
            </div>
        </li>
        <li><a href="javascript:;" role="button" id="sidebar-toggler" class="right-sidebar-toggle bubble header-icon"><i class="ti-layout-sidebar-right"></i><span class="dot bg-danger"></span></a>
        </li>
        <li><a href="{% url 'core:logout' %}" title="Logout" data-toggle="true" role="button" class="header-icon"><i class="ti-power-off"></i></a></li>
    </ul>
</header>
<!-- Header end-->
<div class="main-container">
    <!-- Main Sidebar start-->
    {% if request.user.member.status in 'Active,Paused,Not Verified' %}
        <aside data-mcs-theme="minimal-dark" class="main-sidebar mCustomScrollbar">
            <div class="user">
                <div id="esp-user-profile" data-percent="40" style="height: 104px; width: 104px; line-height: 80px; padding: 12px;" class="easy-pie-chart">
                    {#                <object data="{{ request.user.avatar_url }}" type="image/png" class="avatar img-circle">#}
                    {#                    <img src="{%  static 'back/images/users/19.jpg' %}" alt="" class="avatar img-circle">#}
                    {#                </object>#}
                    <img class="avatar img-circle" src="{{ request.user.avatar_url }}"
                         onerror="if (this.src != '{% static 'back/images/users/19.jpg' %}') this.src = '{% static 'back/images/users/19.jpg' %}';">


                    <span class="status bg-success"></span>
                </div>
                <h4 class="fs-14 text-muted mt-15 mb-5 fw-300"> {{ request.user.first_name }} {{ request.user.last_name }}</h4>
                {% if request.user.member.status == 'Not Verified' %}
                    {% if not request.user.member.is_phone_verified %}
                        <p class="fs-13 mb-0"><a href="javascript:;" id="verify-phone-link">Phone Verification</a></p>
                    {% endif %}
                    {% if not request.user.member.is_email_verified %}
                        <p class="fs-13 mb-0 text-muted"><a href="javascript:;" id="verify-email-link">Email Verification</a></p>
                    {% endif %}
                {% elif request.user.member.status == 'Active' %}
                    <span class="label label-primary">✓ Active</span>
                {% elif request.user.member.status == 'Paused' %}
                    <span class="label label-warning"><i class="fa fa-"></i> Banned</span>
                {% else %}
                    <span class="label label-danger"><i class="fa fa-"></i> {{ request.user.member.status }}</span>
                {% endif %}
            </div>
            <ul class="list-unstyled navigation mb-0">
                {#            <li class="sidebar-header pt-0">Home</li>#}
                <li><a href="{% url 'core:dashboard' %}" class="bubble"><i class="ti-dashboard"></i> Dashboard<span class="badge bg-danger">{{ unread_count }}</span></a></li>
                <li><a href="{% url 'core:market-place' %}" class="bubble"><i class="ti-wallet"></i> GMBC Market <span class="label label-outline label-success">New</span><span
                        class="badge bg-danger">{{ unread_count }}</span></a></li>
                <li class="panel"><a role="button" data-toggle="collapse" data-parent=".navigation" href="#collapse2" aria-expanded="false" aria-controls="collapse2" class="collapsed"><i
                        class="ti-credit-card"></i> GMB Account</a>
                    <ul id="collapse2" class="list-unstyled collapse">
                        <li><a href="{% url 'core:account-activities' %}" class="bubble"><i class="ti-credit-card"></i>  Live</a></li>
                        <li><a href="{% url 'core:statement' %}" class="bubble"><i class="ti-credit-card"></i> Histroy</a></li>
                    </ul>
                </li>
                <li><a href="{% url 'postman:inbox' %}" class="bubble"><i class="ti-email"></i> Message Center</a></li>
                <li><a href="{% url 'core:profile' %}" class="bubble"><i class="ti-user"></i> Profile</a></li>

            </ul>

        </aside>
        <!-- Main Sidebar end-->

        {% block content_body %}{% endblock %}
        <!-- Right Sidebar start-->
        <aside class="right-sidebar closed">
            <ul role="tablist" class="nav nav-tabs nav-justified nav-sidebar">
                <li role="presentation" class="active"><a href="#chat" aria-controls="chat" role="tab" data-toggle="tab"><i class="ti-comment-alt"></i></a></li>
                <li role="presentation"><a href="#announcement" id="announcement-toggler" aria-controls="announcement" role="tab" data-toggle="tab"><i class="ti-announcement"></i></a></li>
                <li role="presentation"><a href="#setting" aria-controls="setting" role="tab" data-toggle="tab"><i class="ti-panel"></i></a></li>
            </ul>
            <div data-mcs-theme="minimal-dark" class="tab-content nav-sidebar-content mCustomScrollbar">
                <div id="chat" role="tabpanel" class="tab-pane fade in active">
                    <form>
                        <div class="form-group has-feedback">
                            <input type="text" aria-describedby="inputChatSearch" placeholder="Chat with..." class="form-control rounded"><span aria-hidden="true"
                                                                                                                                                class="ti-search form-control-feedback"></span><span
                                id="inputChatSearch" class="sr-only">(default)</span>
                        </div>
                    </form>
                    <ul class="chat-list mb-0 fs-12 media-list">
                        <li class="media"><a href="javascript:;" class="conversation-toggle">
                            <div class="media-left avatar"><img src="{% static 'back/images/users/20.jpg' %}" alt="" class="media-object img-circle"><span class="status bg-success"></span></div>
                            <div class="media-body">
                                <h6 class="media-heading">Jane Curtis</h6>
                                <p class="text-muted mb-0">Where are you from?</p>
                            </div>
                            <div class="media-right"><span class="badge bg-danger">2</span></div>
                        </a></li>

                    </ul>
                </div>
                <div id="announcement" role="tabpanel" class="tab-pane fade">
                    <ul id="right-slider" class="media-list mb-0 fs-12">
                        <!--Right Slider-->
                    </ul>
                </div>
                <div id="setting" role="tabpanel" class="tab-pane fade">
                    <form class="form-horizontal fs-12">
                        <div class="clearfix">
                            <h6 class="pull-left">SMS Notifications</h6>
                            <div class="switch pull-right">
                                <input id="setting-1" type="checkbox" checked="">
                                <label for="setting-1" class="switch-success"></label>
                            </div>
                        </div>
                        <p class="text-muted">Send me SMS Notifications on my Transactions</p>
                        <div class="clearfix">
                            <h6 class="pull-left">Email Notifications</h6>
                            <div class="switch pull-right">
                                <input id="setting-2" type="checkbox" checked="">
                                <label for="setting-2" class="switch-success"></label>
                            </div>
                        </div>
                        <p class="text-muted">Send me Email Notifications on my Transactions</p>

                        <div class="clearfix">
                            <h6 class="pull-left"><a href="javascript:;" class="manage-account btn btn-raised btn-block btn-primary">Manage Account</a></h6>
                        </div>
                        <div class="clearfix">
                            <h6 class="pull-left"><a href="javascript:;" class="account-settings btn btn-raised btn-block btn-primary">Social Login</a></h6>
                        </div>

                    </form>
                </div>
            </div>
        </aside>
        <aside class="conversation closed">
            <h5 class="text-center m-0 p-20">Edward Garcia<a href="javascript:;" class="conversation-toggle pull-left"><i class="ti-arrow-left text-muted"></i></a><a href="javascript:;"
                                                                                                                                                                      class="pull-right"><i
                    class="ti-pencil text-muted"></i></a></h5>
            <ul data-mcs-theme="minimal-dark" class="media-list chat-content fs-12 pl-20 pr-20 mCustomScrollbar">
                <li class="media">
                    <div class="media-left avatar"><img src="{% static 'back/images/users/04.jpg' %}" alt="" class="media-object img-circle"><span class="status bg-success"></span></div>
                    <div class="media-body">
                        <p>Hello.</p>
                        <time datetime="2015-12-10T20:50:48+07:00" class="fs-11 text-muted">09:45 PM <i class="ti-check text-success"></i></time>
                    </div>
                </li>
                <li class="media other">
                    <div class="media-body">
                        <p>Hi.</p>
                        <time datetime="2015-12-10T20:50:48+07:00" class="fs-11 text-muted pull-right">09:46 PM <i class="ti-check text-success"></i></time>
                    </div>
                    <div class="media-right avatar"><img src="{% static 'back/images/users/18.jpg' %}" alt="" class="media-object img-circle"><span class="status bg-success"></span></div>
                </li>

            </ul>
            <form class="pl-20 pr-20">
                <div class="form-group has-feedback mb-0">
                    <input type="text" aria-describedby="inputSendMessage" placeholder="Sent a message" class="form-control rounded"><span aria-hidden="true"
                                                                                                                                           class="ti-pencil-alt form-control-feedback"></span><span
                        id="inputSendMessage" class="sr-only">(default)</span>
                </div>
            </form>
        </aside>
        <!-- Right Sidebar end-->
    {% else %}
        <p><h2 class="text-center">{{ request.user.member.status }}</h2></p>
    {% endif %}
</div>
<!-- Demo Settings start-->
<div class="setting closed"><a href="javascript:;" class="setting-toggle fs-16"><i class="ti-palette text-muted"></i></a>
    <h5 class="fs-16 mt-0 mb-20">Header Colors</h5>
    <ul class="list-inline">
        <li><a href="javascript:;" data-color="header-primary" class="mo-xs bg-primary inline-block img-circle header-color"></a></li>
        <li><a href="javascript:;" data-color="header-green" class="mo-xs bg-success inline-block img-circle header-color"></a></li>
        <li><a href="javascript:;" data-color="header-purple" class="mo-xs bg-purple inline-block img-circle header-color"></a></li>
        <li><a href="javascript:;" data-color="header-yellow" class="mo-xs bg-warning inline-block img-circle header-color"></a></li>
        <li><a href="javascript:;" data-color="header-red" class="mo-xs bg-danger inline-block img-circle header-color"></a></li>
    </ul>
    <h5 class="fs-16 mt-0 mb-20">Sidebar Colors</h5>
    <ul class="list-inline">
        <li><a href="javascript:;" data-color="sidebar-dark" class="sidebar-color mo-xs bg-black inline-block img-circle"></a></li>
        <li><a href="javascript:;" data-color="sidebar-light" class="sidebar-color mo-xs bg-default inline-block img-circle"></a></li>
    </ul>
</div>
<!-- Demo Settings end-->
<!-- Bootstrap JavaScript-->
<script type="text/javascript" src="{% static 'bootstrap/js/bootstrap.min.js' %}"></script>
<!-- Malihu Scrollbar-->
<script type="text/javascript" src="{% static 'malihu-custom-scrollbar-plugin/jquery.mCustomScrollbar.concat.min.js' %}"></script>
<!-- Animo.js-->
<script type="text/javascript" src="{% static 'animo.js/animo.min.js' %}"></script>
<!-- Bootstrap Progressbar-->
<script type="text/javascript" src="{% static 'bootstrap-progressbar/bootstrap-progressbar.min.js' %}"></script>
<!-- jQuery Easy Pie Chart-->
<script type="text/javascript" src="{% static 'jquery.easy-pie-chart/dist/jquery.easypiechart.min.js' %}"></script>
<script type="text/javascript" src="{% static 'toastr/toastr.min.js' %}"></script>
<script type="text/javascript" src="{% static 'counterup/jquery.counterup.min.js' %}"></script>
<script type="text/javascript" src="{% static 'moment/moment-with-locales.js' %}"></script>

<link rel="stylesheet" type="text/css" href="{% static 'bootstrap3-dialog/css/bootstrap-dialog.min.css' %}">
<script type="text/javascript" src="{% static 'bootstrap3-dialog/js/bootstrap-dialog.min.js' %}"></script>
<script src="{% static 'js-cookie/js-cookie.js' %}"></script>

<!-- Custom JS-->
<script type="text/javascript" src="{% static 'back/js/second-layout/app.js' %}"></script>
<script type="text/javascript" src="{% static 'back/js/second-layout/demo.js' %}"></script>
{#    <script type="text/javascript" src="{% static 'back/js/page-content/dashboard/index.js' %}"></script>#}

<script src="{% static 'notifications/notify.js' %}" type="text/javascript"></script>
<script>
    var updateTimeago = function () {
        $("span[data-timeago],time[data-timeago]").each(function (i, v) {
            $(v).html(moment($(v).data('timeago')).fromNow());
        });
    };

    function check_address(address){
        if( /[^a-zA-Z0-9]/.test( address )) {
            return false;
        }else if(/^[a-zA-Z]+$/.test(address) || !isNaN(address)){
            return false;
        }else if(address.length < 26 || address.length > 36){
            return false;
        }
        return true;
    }

    function emoji() {
        $.each($("b.emoji,span.emoji,emoji.emoji"), function (i, v) {
            $(v).html(String.fromCodePoint($(v).data("value")))
        });
    }

    function toUTF16(codePoint) {
        var TEN_BITS = parseInt('1111111111', 2);
        if(codePoint.match("^U+")){
            codePoint = codePoint.replace("U+", "0x");
        }else if(!codePoint.match("^0x")){
            codePoint = "0x"+codePoint;
        }
        function u(codeUnit) {
            return '\\u' + codeUnit.toString(16).toUpperCase();
        }

        if (codePoint <= 0xFFFF) {
            return u(codePoint);
        }
        codePoint -= 0x10000;
        // Shift right to get to most significant 10 bits
        var leadSurrogate = 0xD800 + (codePoint >> 10);
        // Mask to get least significant 10 bits
        var tailSurrogate = 0xDC00 + (codePoint & TEN_BITS);
        return u(leadSurrogate) + u(tailSurrogate);
    }

    var hexa = {a:"1F1E6"},
    a2z=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];
    for (var x=1; x<a2z.length; x++){
        hexa[a2z[x]]=(parseInt(hexa.a, 16) + parseInt(x.toString(16), 16)).toString(16)
{#        console.log(x+". "+a2z[x] +'\t'+ (parseInt(hexa.a, 16) + parseInt(x.toString(16), 16)).toString(16))#}
    }


    $(document).ready(function () {
        emoji();
        setInterval(updateTimeago, 30000);

        $('body').on('click', 'li.media a.announcement-toggler', function () {
            $("#sidebar-toggler").trigger("click");
            $("#announcement-toggler").trigger("click");
            {#                console.log($(this).data('id'));#}
            processFeed("{% url 'notifications:mark_as_read' '0000' %}".replace('0000', $(this).data('id')), {}, null, false, 'Get', function (d) {
            }, function (d) {
            });

        });

        $("body").on('click', '.manage-account', function(){
            BootstrapDialog.show({
                title: 'Manage Account',
                message: $('<div></div>').load("{% url 'core:bank-account' %}")
            })
        });

        $(".account-settings").click(function(){
            BootstrapDialog.show({
                title: 'Account Settings',
                message: $('<div></div>').load("{% url 'core:account-settings' %}")
            })
        });

        $(".ph2coin").click(function () {
            BootstrapDialog.show({
              title: "<i class='ti-anchor'></i> Currency Converter",
              message: $('<div></div>').load("{% url 'core:coin-converter' %}"),
            })
        });
    });
    custom_live_notify_list = function (data) {
        var menu = document.getElementById("custom_live_notify_list");
        var right = document.getElementById("right-slider");
        if (menu) {
            menu.innerHTML = right.innerHTML = "";
            for (var i = 0; i < data.unread_list.length; i++) {
                var item = data.unread_list[i];
                var message = ""
                if (typeof item.verb !== 'undefined') {
                    message = message + " " + item.verb;
                }
                menu.innerHTML += '<li class="media"><a href="javascript:;" class="announcement-toggler" data-id="' + (item.id + 110909) + '"><div class="media-body"><h6 class="media-heading">' + item.actor + '</h6><p class="text-muted mb-0">' + message + '</p></div><div class="media-right text-nowrap"><time data-timeago="' + item.timestamp + '" class="fs-11">2 min</time></div></a></li>'
                right.innerHTML += '<li class="media"><div class="media-body"><h6 class="media-heading">' + item.actor + '</h6><p class="text-muted mb-0">' + message + '</p></div></li>';
                updateTimeago();
            }
        }
    }


    function pwd(msg, closable) {
        closable = closable ? true : false;
        var pleaseWaitDialog = new BootstrapDialog({
            message: '<p class="text-center">' + msg + '</p>',
            closeButton: false,
            closable: closable,
            closeByBackdrop: closable,
            closeByKeyboard: closable,
        });
        pleaseWaitDialog.realize();
        pleaseWaitDialog.getModalFooter().hide();
        pleaseWaitDialog.getModalHeader().hide();
        pleaseWaitDialog.open();
        return pleaseWaitDialog;
    }

    function isEmail(email) {
        const re = /^[a-zA-Z0-9.!#$%&’*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;
        return re.test(email);
    };

    function csrfSafeMethod(method) {
        return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
    }

    function processFeed(url, data, blocking, asJson, method, successCallback, errorCallback) {
        {#        var data = $("#searchform").serialize();#}
        {#        $('#searchform').on('submit',function(event){#}
        var pwDialog = null;
        $.ajax({
            type: method,
            url: url,
            data: data,
            dataType: "json",
            processData: ((asJson==null || asJson==false)? true:false),
            contentType: ((asJson==null || asJson==false)? 'application/x-www-form-urlencoded; charset=utf-8':'application/json; charset=utf-8'),
            beforeSend: function (xhr, settings) {
                console.log(this.data)
                var csrftoken = Cookies.get('csrftoken');
                if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                    xhr.setRequestHeader("X-CSRFToken", csrftoken);
                }
                console.log("sending to: ", this.url)
                if (blocking != null) {
                    pwDialog = pwd(blocking);
                }
            },
            success: function (d) {
                if (typeof successCallback === "function") {
                    successCallback(d);
                }
            },
            error: function (d) {
                if (typeof errorCallback === "function") {
                    errorCallback(d);
                }
            },
            complete: function (d) {
                if (blocking != null) {
                    pwDialog.close();
                }
            }
        });
    }

    $("#verify-phone-link").click(function (d) {
        loadPhoneModal();
    });

    $("body").on("click", "#resend-code-link", function (d) {
        processFeed("{% url 'core:resend-code' %}", {}, "Processing...", false, 'POST', function (d) {
            if (d.type == 'Info') {
                BootstrapDialog.alert({message: "<b>" + d.msg + "</b>"});
            } else if (d.type == 'Success') {
                BootstrapDialog.alert({
                    message: "<b>" + d.msg + "</b>", onhide: function (dialog) {
                        location.href = "{% url 'core:dashboard' %}";
                    }
                });
            }
        }, function (d) {
            pwd(d.responseText, true);
        });
    });
    $("body").on("click", "#verify-code-btn", function (d) {
        var code = $("#phone-code").val();
        if (code.length < 6) {
            return;
        }
        processFeed("{% url 'core:verify-phone-code' %}", {code: code}, "Processing...", true, 'POST', function (d) {
            if (d.type == 'Info') {
                BootstrapDialog.alert("<b>" + d.msg + "</b>")
            } else if (d.type == 'Success') {
                BootstrapDialog.alert("<b>" + d.msg + "</b>", function (d) {
                    console.log(d);
                    location.href = "{% url 'core:dashboard' %}";
                });
            }
        }, function (d) {
            pwd(d.responseText, true);
        });
    });

    function loadPhoneModal(dialog) {
        var dialog = new BootstrapDialog({
            title: 'Phone Verification',
            message: '<div class="row"><div class="col-xs-12">We have sent you SMS containing your Phone Verification code <b>{{ request.user.member.phone }}</b></br></br></div><div class="col-md-6 col-sm-12"><div class="input-group"><input type="text" id="phone-code" placeholder="012345" class="form-control" ><div class="input-group-btn"><button type="button" id="verify-code-btn" class="btn btn-primary dropdown-toggle" >Verify Phone</button></div></div></div> <div class="col-md-6 col-sm-12"> <a href="javascript:;" id="resend-code-link" class="btn btn-primary" >Resend Code</a></div></div>',
            closeButton: true,
            closable: true,
            closeByBackdrop: false,
            closeByKeyboard: false
        });
        dialog.realize();
        {#            dialog.getModalFooter().hide();#}
        {#            dialog.getModalHeader().hide();#}
        dialog.open();
    }

    $("#verify-email-link").click(function (d) {
        loadEmailModal();
    });

    $("body").on("click", "#resend-email-link", function (d) {
        processFeed("{% url 'core:resend-email' %}", {}, "Processing...", true, 'POST', function (d) {
            if (d.type == 'Info') {
                BootstrapDialog.alert("<b>" + d.msg + "</b>")
            } else if (d.type == 'Success') {
                BootstrapDialog.alert("<b>" + d.msg + "</b>", function (d) {
                    location.href = "{% url 'core:dashboard' %}";
                });
            }
        }, function (d) {
            BootstrapDialog.alert("<b>" + d.responseText + "</b>")
        });
    });

    function loadEmailModal(dialog) {
        var dialog = new BootstrapDialog({
            title: 'Email Verification',
            message: '<p>  <a href="javascript:;" id="resend-email-link" class="btn btn-primary" >Email Not Received Resend</a></p>',
            closeButton: true,
            closable: true,
            closeByBackdrop: false,
            closeByKeyboard: false
        });
        dialog.realize();
        dialog.open();

    }

    function formatMoney(num, decimalPlace, currency) {
        if (typeof decimalPlace === 'undefined') {
            decimalPlace = 0;
            var p = num.toFixed(2).split(".");
        } else {
            var p = [num + ""]
        }
        if (typeof currency === 'undefined') {
            currency = '';
        }

        return currency + p[0].split("").reverse().reduce(function (acc, num, i, orig) {
                return num == "-" ? acc : num + (i && !(i % 3) ? "," : "") + acc;
            }, "") + ((decimalPlace == 0) ? "" : "." + p[1]);
    }

</script>


{% register_notify_callbacks callbacks='custom_live_notify_list,fill_notification_badge' %}
<script>
    notify_refresh_period = 2 * 60 * 1000;
    $("#sidebar-toggler").click(function () {
        FB.AppEvents.logEvent("viewRightSideBar");
    });
    $("#dropdownMenu1").click(function () {
        FB.AppEvents.logEvent("viewNotification");
    });
</script>
</body>
</html>